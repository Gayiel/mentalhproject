<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Hub page: start everything from here (no auto-redirect) -->
  <title>MindFlow Sanctuary - Mental Health Support</title>
  <style>
    body { 
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; 
      background: linear-gradient(180deg, #E9F7FF, #F0E9FF); 
      color: #2d3748; 
      display: grid; 
      place-items: center; 
      height: 100vh; 
      margin: 0; 
    }
    .card { 
      background: rgba(255, 255, 255, 0.95); 
      backdrop-filter: blur(10px);
      padding: 32px 40px; 
      border-radius: 16px; 
      box-shadow: 0 12px 36px rgba(0, 0, 0, 0.08); 
      text-align: center; 
      max-width: 400px;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    .logo { font-size: 1.8em; font-weight: 700; color: #2d3748; margin-bottom: 12px; }
    .tagline { color: #4a5568; margin-bottom: 20px; font-size: 0.95em; line-height: 1.5; }
  .loading { display: flex; align-items: center; justify-content: center; gap: 8px; color: #48bb78; }
    .spinner { width: 16px; height: 16px; border: 2px solid #e2e8f0; border-top: 2px solid #48bb78; border-radius: 50%; animation: spin 1s linear infinite; }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    a { color: #48bb78; text-decoration: none; font-weight: 500; }
    a:hover { text-decoration: underline; }
    .emergency { font-size: 0.8em; color: #64748b; margin-top: 16px; padding-top: 16px; border-top: 1px solid #e2e8f0; }
    .actions { display: grid; gap: 10px; margin-top: 14px; }
    .btn { display: inline-block; padding: 10px 14px; border-radius: 10px; font-weight: 600; }
    .btn.primary { background: #48bb78; color: #fff; }
    .btn.secondary { background: #667eea; color: #fff; }
    .btn.muted { background: #edf2f7; color: #2d3748; }
    .note { font-size: 0.85em; color: #64748b; margin-top: 8px; }
  </style>
</head>
<body>
  <div class="card">
    <div class="logo">ðŸŒ± MindFlow Sanctuary</div>
    <div class="tagline">Your secure, confidential space for mental wellness</div>
    <div class="actions">
      <a class="btn primary" href="unified-sanctuary.html">Enter Sanctuary</a>
      <a class="btn secondary" href="resources.html">Browse Resources</a>
      <a class="btn muted" href="test-dashboard.html">API & Developer Dashboard</a>
    </div>
    <div class="note" id="server-note">Checking server statusâ€¦</div>
    <div style="margin-top: 18px; padding-top: 16px; border-top: 1px solid #e2e8f0; font-size: 0.88em; color: #4a5568;">
      <div style="font-weight: 600; margin-bottom: 8px;">Direct access to legacy experiences</div>
      <div class="actions" style="margin-top: 0;">
        <a class="btn muted" href="mind-flow-complete.html">MindFlow (Legacy full experience)</a>
        <a class="btn muted" href="collaborative-mental-health.html">Collaborative Counselor Workspace</a>
      </div>
    </div>
    <div class="emergency">
      <strong>Crisis support:</strong> Call 988 or 911 for immediate help
    </div>
  </div>
  <!-- Load main JavaScript first -->
  <script src="js/main.js"></script>
  
  <script>
    // Light server availability check (optional) to hint about live metrics
    (async function(){
      const note = document.getElementById('server-note');
      if (!note) return;
      
      try {
        // Add timeout to prevent hanging
        const controller = new AbortController();
        const timeoutId = setTimeout(() => controller.abort(), 5000);
        
        const r = await fetch('/healthz', {
          cache: 'no-store',
          signal: controller.signal
        });
        
        clearTimeout(timeoutId);
        
        if (r.ok) {
          const data = await r.json();
          note.textContent = 'Server online â€” live metrics and database features are enabled.';
          note.style.color = '#2f855a';
          window.mindflowState.isConnected = true;
        } else {
          throw new Error(`Server responded with ${r.status}`);
        }
      } catch(e) {
        console.log('Server check failed:', e.message);
        note.textContent = 'Server offline â€” you can still explore the app, but live data will be static. Start it with: node server.js';
        note.style.color = '#b7791f';
        window.mindflowState.isConnected = false;
      }
    })();
  </script>
</body>
</html>